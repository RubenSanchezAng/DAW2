<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        /* ==========================================
        üíæ ALMACENANDO DATOS EN EL NAVEGADOR
        ========================================== */

        /* ---------------------------------
        üîπ INTRODUCCI√ìN
        ---------------------------------
        localStorage y sessionStorage permiten guardar pares clave/valor en el navegador.
        Diferencias principales:
        - localStorage ‚Üí persiste tras cerrar/reabrir navegador
        - sessionStorage ‚Üí persiste solo en la pesta√±a actual
        - No se env√≠an al servidor como las cookies
        - Datos vinculados al origen (dominio/protocolo/puerto)
        */

        /* ---------------------------------
        üß© M√âTODOS PRINCIPALES
        --------------------------------- */
        localStorage.setItem('miClave', 'valor');      // Guardar
        localStorage.getItem('miClave');               // Obtener
        localStorage.removeItem('miClave');            // Borrar
        localStorage.clear();                           // Borrar todo
        localStorage.key(0);                            // Obtener clave por √≠ndice
        localStorage.length;                            // N√∫mero de √≠tems almacenados

        /* ---------------------------------
        üîπ Ejemplo b√°sico localStorage
        --------------------------------- */
        localStorage.setItem('test', '1');
        alert(localStorage.getItem('test')); // 1

        /* Acceso tipo objeto (no recomendado) */
        localStorage.test = '2';
        alert(localStorage.test); // 2
        delete localStorage.test;

        /* ‚ö†Ô∏è Problema con claves especiales */
        let clave = 'length';
        localStorage[clave] = 5; // Error, usar setItem/getItem

        /* ---------------------------------
        üîπ Iterando sobre claves
        --------------------------------- */
        for (let i = 0; i < localStorage.length; i++) {
        let clave = localStorage.key(i);
        alert(`${clave}: ${localStorage.getItem(clave)}`);
        }

        /* Filtrar claves propias usando hasOwnProperty */
        for (let clave in localStorage) {
        if (!localStorage.hasOwnProperty(clave)) continue;
        alert(`${clave}: ${localStorage.getItem(clave)}`);
        }

        /* Usando Object.keys */
        let claves = Object.keys(localStorage);
        for (let clave of claves) {
        alert(`${clave}: ${localStorage.getItem(clave)}`);
        }

        /* ---------------------------------
        üîπ Solo strings
        --------------------------------- */
        localStorage.edad = 30;             // Se convierte a "30"
        localStorage.objeto = { nombre: 'Juan' };
        alert(localStorage.objeto);          // [object Object]

        // Guardar objetos con JSON
        localStorage.objeto = JSON.stringify({ nombre: 'Juan' });
        let objeto = JSON.parse(localStorage.objeto);
        alert(objeto.nombre); // Juan

        /* Mostrar todo el localStorage en formato legible */
        alert(JSON.stringify(localStorage, null, 2));

        /* ---------------------------------
        üîπ sessionStorage
        --------------------------------- */
        sessionStorage.setItem('test', '1');
        alert(sessionStorage.getItem('test')); // 1 despu√©s de recargar
        // Nueva pesta√±a ‚Üí sessionStorage vac√≠o

        /* ---------------------------------
        üîπ EVENTO STORAGE
        --------------------------------- */
        /*
        Se dispara al actualizar localStorage/sessionStorage
        Propiedades del evento:
        - key ‚Üí clave modificada (null si se llam√≥ a clear)
        - oldValue ‚Üí valor anterior (null si se a√±adi√≥)
        - newValue ‚Üí nuevo valor (null si se borr√≥)
        - url ‚Üí url del documento donde ocurri√≥ el cambio
        - storageArea ‚Üí localStorage o sessionStorage
        */
        window.onstorage = evento => {
        if (evento.key != 'ahora') return;
        alert(`${evento.key}: ${evento.newValue} en ${evento.url}`);
        };

        // Disparar evento desde otra ventana
        localStorage.setItem('ahora', Date.now());

        /* ---------------------------------
        üìå RESUMEN
        ---------------------------------
        üî∏ localStorage:
            - Compartido entre pesta√±as/ventanas del mismo origen
            - Persiste tras cerrar el navegador
        üî∏ sessionStorage:
            - Solo en la pesta√±a actual
            - Persiste tras refrescar, muere al cerrar pesta√±a
        üî∏ Ambos:
            - setItem(clave, valor) ‚Üí guardar
            - getItem(clave) ‚Üí obtener
            - removeItem(clave) ‚Üí borrar
            - clear() ‚Üí borrar todo
            - key(indice) ‚Üí obtener clave por √≠ndice
            - length ‚Üí n√∫mero de √≠tems almacenados
            - Las claves y valores son strings
            - El evento storage permite reaccionar a cambios en otras ventanas
        */

    </script>
</body>
</html>